import{m as r}from"./vuex-ab0c87e4.js";import{b as l,R as o,c as n,d as c,e as m,f as u,g as d,n as f}from"./app-f4f25d77.js";import"./axios-4a70c6fc.js";import"./vue-27ef7f4b.js";import"./async-validator-33e353d7.js";import"./babel-runtime-69a8a51d.js";import"./vue-router-b30a8712.js";import"./vue-cookie-6191409e.js";import"./tiny-cookie-20745a96.js";import"./vue-axios-c4ba63d4.js";import"./qs-68262ff1.js";import"./side-channel-4ad99da8.js";import"./get-intrinsic-bd2830fd.js";import"./has-symbols-e8f3ca0e.js";import"./has-proto-f7d0b240.js";import"./function-bind-22e7ee79.js";import"./has-26d28e02.js";import"./call-bind-e5c1c8b0.js";import"./object-inspect-2769fc76.js";import"./element-ui-3130f6a7.js";import"./resize-observer-polyfill-abe38d2e.js";import"./throttle-debounce-83204b99.js";import"./babel-helper-vue-jsx-merge-props-f37b6d04.js";import"./normalize-wheel-3e66c890.js";import"./deepmerge-1ee2baff.js";import"./nprogress-d48da9fa.js";import"./moment-fbc5633a.js";/* empty css                     */import"./element-tiptap-376f8dc6.js";import"./tiptap-6f0a2729.js";import"./prosemirror-state-d26f883c.js";import"./prosemirror-model-2d5d1d45.js";import"./orderedmap-1b52af60.js";import"./prosemirror-transform-7d6a52dd.js";import"./prosemirror-view-329e6b0d.js";import"./prosemirror-dropcursor-5184b87b.js";import"./prosemirror-gapcursor-d7df0b38.js";import"./prosemirror-keymap-a3c7cf8f.js";import"./w3c-keyname-a25e4cc1.js";import"./prosemirror-commands-9594733f.js";import"./prosemirror-inputrules-2a9a1b7b.js";import"./tiptap-utils-79441358.js";import"./tiptap-extensions-2e008a14.js";import"./tiptap-commands-9ba0d5a0.js";import"./prosemirror-schema-list-587b3b24.js";import"./highlight.js-9f6fcca9.js";import"./fault-8318a74e.js";import"./format-7101f815.js";import"./prosemirror-tables-c55e9af7.js";import"./prosemirror-history-420343bb.js";import"./rope-sequence-5ceeafee.js";import"./prosemirror-utils-e4018d71.js";import"./mavon-editor-7772d28a.js";const p={computed:{...r({tableHeight:s=>s.tableHeight})},data:function(){return{loading:!1,datas:null,configs:null,roles:null,slection:[],params:{page:1,kwd:"",status:0,rid:0},button:{loading:!1,disable:!1,text:"提 交"},dialog:{title:"",show:!1},avatars:["d","1","2","3","4","5","6","7"],form:null,rules:{username:[{required:!0,message:"请填写管理员账户",trigger:"blur"}],nickname:[{required:!0,message:"请填写管理员昵称",trigger:"blur"}]}}},activated(){this.role(),this.config(),this.list()},methods:{config(){l().then(s=>{s.status?this.$func.error(s.message):this.configs=s.data})},role(){o().then(s=>{s.status===0&&(this.roles=s.data)})},async list(){await this.$func.verify("manager.list"),this.loading=!0,n(this.params).then(s=>{s.status?this.$func.error(s.message):this.datas=s.data,this.loading=!1}).catch(s=>{this.loading=!1})},async create(){await this.$func.verify("manager.create"),this.form={username:"",nickname:"",avatar:"d",rid:1,password:"",status:1},this.dialog.title="新增管理员",this.dialog.show=!0,this.$nextTick(()=>{this.$refs.form.clearValidate()})},async edit(s){await this.$func.verify("manager.edit"),this.form={id:s.id,nickname:s.nickname,avatar:s.avatar,username:s.username,rid:s.rid,password:"",status:s.status},this.dialog.title="编辑管理员",this.dialog.show=!0,this.$nextTick(()=>{this.$refs.form.clearValidate()})},update(){this.$refs.form.validate(s=>{s&&(this.button.disabled=!0,this.button.loading=!0,this.button.text="提交中...",c(this.form).then(t=>{t.status?this.$func.error(t.message):this.$func.success(t.message).then(()=>{this.dialog.show=!1,this.list()}),this.button.disabled=!1,this.button.loading=!1,this.button.text="提 交"}).catch(t=>{this.button.disabled=!1,this.button.loading=!1,this.button.text="提 交"}))})},multiple(s){this.slection=[],s.length&&s.forEach(t=>{this.slection.push(t.id)})},async active(){if(await this.$func.verify("manager.active"),!this.slection.length)return this.$func.error("请选择你要操作的数据"),!1;m({id:this.slection}).then(s=>{s.status?this.$func.error(s.message):this.list()})},async lock(){if(await this.$func.verify("manager.lock"),!this.slection.length)return this.$func.error("请选择你要操作的数据"),!1;u({id:this.slection}).then(s=>{s.status?this.$func.error(s.message):this.list()})},del(){if(!this.slection.length)return this.$func.error("请选择你要操作的数据"),!1;this.destroy(this.slection)},async destroy(s){await this.$func.verify("manager.destroy"),this.$confirm("您确定要删除选中的该条信息吗？","提示",{type:"warning",confirmButtonText:"确 定",cancelButtonText:"取 消"}).then(()=>{d({id:s}).then(t=>{t.status?this.$func.error(t.message):this.list()})}).catch(()=>{})},search(){this.params.page=1,this.list()},page(s){this.params.page=s,this.list()},select(s){this.form.avatar=s}}};var h=function(){var t=this,e=t._self._c;return e("div",{staticClass:"board-content"},[e("div",{staticClass:"board-header"},[e("div",{staticClass:"board-search"},[t.configs?e("div",{staticClass:"search-item"},[e("el-select",{attrs:{size:"small",filterable:""},model:{value:t.params.status,callback:function(a){t.$set(t.params,"status",a)},expression:"params.status"}},[e("el-option",{attrs:{value:0,label:"全部状态"}}),t._l(t.configs.status,function(a,i){return e("el-option",{key:i,attrs:{label:a,value:i}})})],2)],1):t._e(),t.roles?e("div",{staticClass:"search-item"},[e("el-select",{attrs:{size:"small"},model:{value:t.params.rid,callback:function(a){t.$set(t.params,"rid",a)},expression:"params.rid"}},[e("el-option",{attrs:{value:0,label:"全部角色"}}),t._l(t.roles,function(a,i){return e("el-option",{key:i,attrs:{label:a.title,value:a.id}})})],2)],1):t._e(),e("div",{staticClass:"search-item"},[e("el-input",{attrs:{placeholder:"请输入用户名/昵称",size:"small",clearable:""},model:{value:t.params.kwd,callback:function(a){t.$set(t.params,"kwd",a)},expression:"params.kwd"}})],1),e("div",{staticClass:"search-item"},[e("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-search"},on:{click:function(a){return t.search()}}},[t._v("搜索")])],1)]),e("div",{staticClass:"board-handle"},[e("el-button",{attrs:{type:"warning",icon:"fa fa-refresh",size:"small"},on:{click:function(a){return t.list()}}},[t._v(" 刷新")]),e("el-button",{attrs:{type:"primary",icon:"fa fa-plus",size:"small"},on:{click:function(a){return t.create()}}},[t._v(" 新增")]),e("el-button",{attrs:{type:"success",icon:"fa fa-unlock-alt",size:"small"},on:{click:function(a){return t.active()}}},[t._v(" 启用")]),e("el-button",{attrs:{type:"danger",icon:"fa fa-lock",size:"small"},on:{click:function(a){return t.lock()}}},[t._v(" 锁定")]),e("el-button",{attrs:{type:"info",icon:"fa fa-trash",size:"small"},on:{click:function(a){return t.del()}}},[t._v(" 删除")])],1)]),e("div",{staticClass:"board-main"},[t.datas?e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"multipleHandle",attrs:{"element-loading-text":"努力加载中...","element-loading-spinner":"el-icon-loading",stripe:"","tooltip-effect":"dark",height:t.tableHeight,data:t.datas.data,border:""},on:{"selection-change":t.multiple}},[e("el-table-column",{attrs:{type:"selection",width:"45",align:"center"}}),e("el-table-column",{attrs:{prop:"id",label:"编号",width:"65",align:"center"}}),e("el-table-column",{attrs:{prop:"thumb",label:"头像",width:"70",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-image",{staticClass:"board-table-image",attrs:{src:"/image/admin/"+a.row.avatar+".jpg","preview-src-list":["/storage/image/admin/"+a.row.avatar+".jpg"]}})]}}],null,!1,3363897767)}),e("el-table-column",{attrs:{prop:"username",label:"用户名",width:"150"}}),e("el-table-column",{attrs:{prop:"nickname",label:"昵称",width:"150"}}),e("el-table-column",{attrs:{prop:"role.title",label:"角色",width:"140"}}),e("el-table-column",{attrs:{prop:"status_text",label:"状态",width:"80",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-tag",{attrs:{type:t.$func.formatTag(a.row.status+2)}},[t._v(t._s(a.row.status_text))])]}}],null,!1,826915959)}),e("el-table-column",{attrs:{label:"操作",fixed:"right","min-width":"260"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{type:"primary",icon:"fa fa-edit",size:"mini",plain:""},on:{click:function(i){return t.edit(a.row)}}},[t._v(" 编辑 ")]),e("el-button",{attrs:{type:"info",icon:"fa fa-trash",size:"mini",plain:""},on:{click:function(i){return t.destroy(a.row.id)}}},[t._v(" 删除 ")])]}}],null,!1,697974088)})],1):t._e()],1),e("pagination",{attrs:{datas:t.datas},on:{page:t.page}}),e("el-dialog",{staticClass:"board-dialog",attrs:{fullscreen:"","close-on-click-modal":!1,"close-on-press-escape":!1,title:t.dialog.title,visible:t.dialog.show,center:""},on:{"update:visible":function(a){return t.$set(t.dialog,"show",a)}}},[t.form?e("el-form",{ref:"form",staticClass:"board-form",attrs:{model:t.form,rules:t.rules,"label-width":"120px"}},[e("div",{staticClass:"item-title"},[t._v("基本信息"),e("div",{staticClass:"title-note"},[e("span",[t._v("* ")]),t._v("为必填项")])]),e("div",{staticClass:"form-item"},[e("el-form-item",{attrs:{label:"角 色：",prop:"rid",required:""}},[e("el-select",{attrs:{size:"medium"},on:{change:function(a){return t.list()}},model:{value:t.form.rid,callback:function(a){t.$set(t.form,"rid",a)},expression:"form.rid"}},t._l(t.roles,function(a,i){return e("el-option",{key:i,attrs:{label:a.title,value:a.id}})}),1)],1),e("el-form-item",{attrs:{label:"账 户：",prop:"username"}},[e("el-input",{attrs:{placeholder:"请填写管理员账户",size:"medium",clearable:""},model:{value:t.form.username,callback:function(a){t.$set(t.form,"username",a)},expression:"form.username"}})],1),e("el-form-item",{attrs:{label:"昵 称：",prop:"nickname"}},[e("el-input",{attrs:{placeholder:"请填写管理员昵称",size:"medium",clearable:""},model:{value:t.form.nickname,callback:function(a){t.$set(t.form,"nickname",a)},expression:"form.nickname"}})],1),t.form.id==0?e("el-form-item",{attrs:{label:"密 码：",prop:"password"}},[e("el-input",{attrs:{placeholder:"请填写管理员密码，默认123456",size:"medium",clearable:"",onfocus:"this.type='password'"},model:{value:t.form.password,callback:function(a){t.$set(t.form,"password",a)},expression:"form.password"}})],1):e("el-form-item",{attrs:{label:"密 码：",prop:"password"}},[e("el-input",{attrs:{placeholder:"请填写管理员密码，不填写表示不修改密码",size:"medium",clearable:"",onfocus:"this.type='password'"},model:{value:t.form.password,callback:function(a){t.$set(t.form,"password",a)},expression:"form.password"}})],1),e("el-form-item",{attrs:{label:"头 像：",prop:"avatar"}},[e("div",{staticClass:"form-avatar"},t._l(t.avatars,function(a,i){return e("img",{key:i,class:a==t.form.avatar?"active":"",attrs:{src:"/image/admin/"+a+".jpg",alt:""},on:{click:function(v){return t.select(a)}}})}),0)]),e("el-form-item",{attrs:{label:"状 态：",prop:"status"}},[e("el-radio-group",{attrs:{size:"medium"},model:{value:t.form.status,callback:function(a){t.$set(t.form,"status",a)},expression:"form.status"}},t._l(t.configs.status,function(a,i){return e("el-radio",{key:i,attrs:{label:Number(i),border:""}},[t._v(t._s(a)+" ")])}),1)],1)],1),e("div",{staticClass:"board-form-item"})]):t._e(),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{type:"primary",loading:t.button.loading,disabled:t.button.disable},on:{click:t.update}},[t._v(t._s(t.button.text))]),e("el-button",{staticClass:"close-btn",on:{click:function(a){t.dialog.show=!1}}},[t._v("关 闭")])],1)],1)],1)},g=[],b=f(p,h,g,!1,null,"e9d30fcb",null,null);const vt=b.exports;export{vt as default};
